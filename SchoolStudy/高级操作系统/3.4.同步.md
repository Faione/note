# 同步

- [同步](#同步)
  - [一、基本概念](#一基本概念)
  - [二、临界区和原子操作](#二临界区和原子操作)

## 一、基本概念

**并发冲突**

- 定义
  - 两个或两个以上执行主体对共享资源的冲突性竞争访问
  - 导致执行结果不可预知，甚至对系统运行产生破坏性影响

- 产生并发冲突的条件
  - 资源共享条件
  - 时间重叠条件
  - 状态更改条件: 至少一个访问改变资源状态或影响其他访问结果

**解决并发冲突**

- 破坏资源共享条件
- 破坏时间重叠条件
  - 打乱时间重叠的执行次序
  - 单核系统中，禁用中断，消除可能的进程执行交叉
  - 全局锁

- 主要技术

<table>
<tbody>

<tr>
<th>技术</th>
<th>方式</th>
<th>原理</th>
</tr>

<tr>
<td>Per-CPU变量</td>
<td align=left rowspan=2>
将共享资源split为非共享资源
</td>
<td rowspan=2>
破坏资源共享条件
</td>
</tr>

<tr>
<td>资源静态划分</td>
</tr>

<tr>
<td>原子操作</td>
<td align=left>
通过原子操作分割并发访问
</td>
<td rowspan=2>
破坏冲突的时间重叠
</td>
</tr>

<tr>
<td>内存屏障</td>
<td align=left>
限制全局的内存访问顺序
</td>
</tr>

<tr>
<td>锁、信号量</td>
<td align=left>
通过锁协调机制，分离访问
</td>
<td rowspan=3>
破坏冲突的时间重叠
</td>
</tr>

<tr>
<td>RC锁</td>
<td align=left>
通过指针实现无锁访问 
</td>
</tr>

<tr>
<td>禁止中断、软中断</td>
<td align=left>
通过禁止中断，避免并发执行
</td>
</tr>

</tbody>
</table>

## 二、临界区和原子操作

- 临界资源
  - 两个或以上的进程不能同时使用的资源
- 临界资源的访问

```
repeat
    进入区
    临界区
    退出区
    剩余区
until false
```


# 超标量-IPL极限
> H&P5，Ch3：p192-p202, p213-p221


- issue数量与commit数量相同


- 直接相联 写入时无法并行，写入性能弱于读
  - 写分为两个步骤，匹配Tag -> 写入Word
- 猜测执行的结果一定要buffer，并判断buffer换入换出的时机

## 一、动态调度的超标量处理器

- 多发射对流水线的结构影响不大，主要对各种总线进行拓宽
- 多发射对于流水线控制逻辑的改造主要有两点
  - Issue阶段: 每个周期要将多条指令发送到保留站和ROB中
    - 分析发射包中的指令与已发送指令之间的依赖
    - 分析发射包中的指令之间的依赖
    - 在一个周期内完成
  - Commit阶段: 每个周期要提交多条指令
    - 提交速度小于发射速度，则流水线最终会堵住

### (1) Issue逻辑

>ROB: Re-Order Buffer

1. 为指令包中的指令分配保留站和ROB入口
   - 通过预留的方式分配
   - 限制指令包中每种类型指令的最大数量
   - 如果无法预留，则将指令包拆分
     - 剩余指令作为下一个指令包，在下一个周期发射
2. 分析指令包中各指令之间的依赖关系
   - 单发射时，前序指令译码已完成，对后续指令进行冲突分析时可以引用先前的译码结果
   - 多发射时，缺乏可参考信息，需要对任何可能的组合进行判定
3. 根据依赖关系初始化所分配的保留站和ROB
   - 如果一条指令依赖于指令包中的前一条指令，则用前序指令的ROB设置该指令的保留站
   - 否则，使用已有的寄存器状态信息设置该指令的保留站和ROB

<!-- TODO: 熟悉过程 -->

## 二、ILP的极限

- 启示
  - 既然复杂的流水线也无法突破程序本身固有的ILP极限，反而限制了主频的提高，能不能做简单的流水线，把主频做高，同时把cache做大
  - 既然单个指令流存在ILP极限，能否同时运行多个并发指令流？这就是超线程、多核、多处理器的基本思想


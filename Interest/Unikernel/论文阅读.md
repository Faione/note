# Unikernels: Library Operating Systems for the Cloud

## 阅读记录

### Problem & Background

- background， 计算虚拟化
- problem
  - 现行的VM虽然将应用程序封装在虚拟机镜像中，但是与原本的系统相比，尽管VM中运行特定的应用，但是其所有使用的系统镜像并没有特殊化

### Challenges



### State-of-the-arts

- hypervisor
- lib OS

### Key insights/ideas/techniques

- Appliance
  - 配置
    - 不同于通过配置文件将诸如数据库、web服务连接在一起，unikernels则将这些应用视为单个程序中的库，使得配置的定义变得显示且可编程化
  - 安全
    - 在外部，通过ssl/ssh等协议信任外部实体
    - 在内部，通过专门化编译，运行时的普遍类型安全，以及hypervisor和工具链扩展，防止不可见的编译器或运行时错误
  - 单地址空间
    - 由于访问控制依赖于语言的类型安全机制来强制执行，而不再依赖于用户空间进程，因此虚拟地址可以进一步简化为单地址空间模型
  - 密封
    - 通过在Xen中增加功能，以使得编译后的Appliance使用 W^X 的内存访问策略
  - 地址空间随机化
    - 编译系统镜像时实现地址随机化

> Write Xor Execute (W^X)
> 应用程序用户空间中的每个页都可以是可写或可执行的，但不能同时可以又可执行

- Mirage
  - 功能
    - 编译和链接 OCaml 代码为一个可以在Xen中运行的VM镜像
  - Ocaml语言
  - PVBoot Library
    - 提供初始化一个单VCPU VM 和 Xen event channels，并跳转至入口方法的支持
    - 与传统OS不同，不支持多进程和非阻塞的线程
    - 提供两种内存页面分配器
      - Slab
        - 支持C代码
      - Extent
        - 保留一个连续的内存区域
        - 以2MB的块进程操作，并允许映射到 x86-64 的超级页
      - 内存区域中被静态地分配给不同的角色
        - 如 垃圾收集堆，I/O 数据页
    - Domainpoll function，阻塞 一组通道和超时的 VM
    - 提供最小的异步支持
      - 事件驱动的VM将会休眠，知道I/O可用或超时
  - Lauguage Runtime


### Lessons learned from experiments
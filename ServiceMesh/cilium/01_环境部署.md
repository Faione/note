
## 基于helm进行安装

```shell
# 增加repo
$ helm repo add cilium https://helm.cilium.io/

# 安装
$ helm install cilium cilium/cilium --version 1.12.1 \
  --namespace kube-system
```

helm upgrade cilium cilium/cilium --version 1.12.1 \
  --namespace kube-system \
  --reuse-values \
  --set hubble.metrics.enabled="{flow:destinationContext=pod;namespace;sourceContext=pod;namespace,http:destinationContext=pod;namespace;sourceContext=pod;namespace}"

- 需要在prometheus中删除过滤配置，以监控其他pod的指标数据 

helm upgrade cilium cilium/cilium --version 1.12.1 \
  --namespace kube-system \
  --reuse-values \
  --set hubble.metrics.enabled=""



kubectl -n cilium-monitoring port-forward service/prometheus --address 0.0.0.0 --address :: 3000:9090

kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing
kubectl exec tiefighter -- curl -s -XPUT deathstar.default.svc.cluster.local/v1/exhaust-port
kubectl exec xwing -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing